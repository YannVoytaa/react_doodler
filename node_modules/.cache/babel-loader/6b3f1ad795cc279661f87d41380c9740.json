{"ast":null,"code":"import _classCallCheck from\"/home/yannvoytaa/dev/react/doodler/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/yannvoytaa/dev/react/doodler/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/yannvoytaa/dev/react/doodler/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/yannvoytaa/dev/react/doodler/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import Floor from'./Floor';import Doodler from'./Doodler';var WIDTH=400,HEIGHT=800,FLOOR_W=80,FLOOR_H=15,DOODLER_W=64,DOODLER_H=64;var movePlatforms=false,left=false,right=false,jumping=false,interval=null,result=0;window.onkeyup=function(e){if(e.key==='ArrowLeft')left=false;if(e.key==='ArrowRight')right=false;};window.onkeydown=function(e){if(e.key==='ArrowLeft')left=true;if(e.key==='ArrowRight')right=true;};var Grid=/*#__PURE__*/function(_React$Component){_inherits(Grid,_React$Component);var _super=_createSuper(Grid);function Grid(){var _this;_classCallCheck(this,Grid);_this=_super.call(this);_this.state={'pos':[],'doodler':{},'doodler_speed':{'vel':0,'acc':10}};/*setInterval(()=>{\n      this.setState((prev)=>{'doodler':{'x':prev.doodler.x,'y':prev.doodler.y+prev.doodler_speed.acc},'doodler_speed':{'vel':prev.doodler_speed.vel+prev.doodler_speed.acc,'acc',prev.doodler_speed.acc+1}})\n    },1000)*/return _this;}_createClass(Grid,[{key:\"jump\",value:function jump(){console.log(++result);this.setState(function(prev){var tab=[];var x=Math.floor(Math.random()*(WIDTH-FLOOR_W));var y=20;tab.push({'x':x,'y':y});prev.pos.forEach(function(item,i){tab.push({'x':item.x,'y':item.y});});movePlatforms=true;//console.log(tab)\nreturn{'pos':tab};});}},{key:\"colide\",value:function colide(){var _this2=this;var tak=false;this.state.pos.forEach(function(platform,i){var takx=false;var taky=false;var doodler=_this2.state.doodler;if(platform.x<doodler.x&&doodler.x<platform.x+FLOOR_W){takx=true;}if(platform.x<doodler.x+DOODLER_W&&doodler.x+DOODLER_W<platform.x+FLOOR_W){takx=true;}if(platform.y<=doodler.y+DOODLER_H&&doodler.y+DOODLER_H<=platform.y+FLOOR_H)taky=true;if(_this2.state.doodler_speed.acc<0)takx=false;if(!tak)tak=takx&&taky;if(tak&&i!=_this2.state.pos.length-1&&jumping===false){jumping=true;_this2.jump();}});return tak;}},{key:\"control\",value:function control(){//1console.log(this.state.doodler_speed.acc)\nthis.setState(function(prev){return{'doodler':{'x':prev.doodler.x+(right-left)*10,'y':prev.doodler.y+prev.doodler_speed.acc},'doodler_speed':{'vel':prev.doodler_speed.vel+prev.doodler_speed.acc,'acc':prev.doodler_speed.acc+1}};});if(movePlatforms){var gap=7;this.setState(function(prev){var tab=[];prev.pos.forEach(function(item,i){if(item.y+gap>=HEIGHT){movePlatforms=false;jumping=false;}else tab.push({'x':item.x,'y':item.y+gap});});return{'pos':tab,'doodler':{'x':prev.doodler.x,'y':prev.doodler.y+gap}};});}if(this.state.doodler.y+DOODLER_H>HEIGHT){clearInterval(interval);this.setState(function(prev){return{'doodler':{'x':prev.doodler.x,'y':HEIGHT-DOODLER_H}};});}if(this.colide()){this.setState(function(prev){return{'doodler_speed':{'acc':-17,'vel':-prev.doodler_speed.vel}};});}}},{key:\"componentDidMount\",value:function componentDidMount(){var _this3=this;var tab=[];for(var i=1;i<=5;i++){var x=Math.floor(Math.random()*(WIDTH-FLOOR_W));var y=130*i+20;tab.push({'x':x,'y':y});}var doodler={'x':tab[tab.length-1].x+FLOOR_W/2-DOODLER_W/2,'y':tab[tab.length-1].y-170};this.setState({'pos':tab,'doodler':doodler});interval=setInterval(function(){_this3.control();},50);}},{key:\"render\",value:function render(){var floors=this.state.pos.map(function(item){return/*#__PURE__*/React.createElement(Floor,{x:item.x,y:item.y});});return/*#__PURE__*/React.createElement(\"div\",{className:\"grid\"},floors,/*#__PURE__*/React.createElement(Doodler,{left:left,right:right,x:this.state.doodler.x,y:this.state.doodler.y}));}}]);return Grid;}(React.Component);export default Grid;","map":{"version":3,"sources":["/home/yannvoytaa/dev/react/doodler/src/Grid.js"],"names":["React","Floor","Doodler","WIDTH","HEIGHT","FLOOR_W","FLOOR_H","DOODLER_W","DOODLER_H","movePlatforms","left","right","jumping","interval","result","window","onkeyup","e","key","onkeydown","Grid","state","console","log","setState","prev","tab","x","Math","floor","random","y","push","pos","forEach","item","i","tak","platform","takx","taky","doodler","doodler_speed","acc","length","jump","vel","gap","clearInterval","colide","setInterval","control","floors","map","Component"],"mappings":"olBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,GAAMC,CAAAA,KAAK,CAAC,GAAZ,CAAiBC,MAAM,CAAC,GAAxB,CAA6BC,OAAO,CAAC,EAArC,CAAwCC,OAAO,CAAC,EAAhD,CAAmDC,SAAS,CAAC,EAA7D,CAAgEC,SAAS,CAAC,EAA1E,CACA,GAAIC,CAAAA,aAAa,CAAC,KAAlB,CAAwBC,IAAI,CAAC,KAA7B,CAAmCC,KAAK,CAAC,KAAzC,CAA+CC,OAAO,CAAC,KAAvD,CAA6DC,QAAQ,CAAC,IAAtE,CAA2EC,MAAM,CAAC,CAAlF,CACAC,MAAM,CAACC,OAAP,CAAe,SAASC,CAAT,CAAW,CACxB,GAAGA,CAAC,CAACC,GAAF,GAAQ,WAAX,CAAuBR,IAAI,CAAC,KAAL,CACvB,GAAGO,CAAC,CAACC,GAAF,GAAQ,YAAX,CAAwBP,KAAK,CAAC,KAAN,CACzB,CAHD,CAIAI,MAAM,CAACI,SAAP,CAAiB,SAASF,CAAT,CAAW,CAC1B,GAAGA,CAAC,CAACC,GAAF,GAAQ,WAAX,CAAuBR,IAAI,CAAC,IAAL,CACvB,GAAGO,CAAC,CAACC,GAAF,GAAQ,YAAX,CAAwBP,KAAK,CAAC,IAAN,CACzB,CAHD,C,GAIMS,CAAAA,I,wGACJ,eAAa,sCACX,wBACA,MAAKC,KAAL,CAAW,CACT,MAAM,EADG,CAET,UAAU,EAFD,CAGT,gBAAgB,CAAC,MAAM,CAAP,CAAS,MAAM,EAAf,CAHP,CAAX,CAKA;;aAPW,aAUZ,C,oDACK,CACJC,OAAO,CAACC,GAAR,CAAY,EAAET,MAAd,EACA,KAAKU,QAAL,CAAc,SAAAC,IAAI,CAAE,CAClB,GAAIC,CAAAA,GAAG,CAAC,EAAR,CACA,GAAIC,CAAAA,CAAC,CAACC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,IAAe3B,KAAK,CAACE,OAArB,CAAX,CAAN,CACA,GAAI0B,CAAAA,CAAC,CAAC,EAAN,CACAL,GAAG,CAACM,IAAJ,CAAS,CAAC,IAAIL,CAAL,CAAO,IAAII,CAAX,CAAT,EACAN,IAAI,CAACQ,GAAL,CAASC,OAAT,CAAiB,SAACC,IAAD,CAAOC,CAAP,CAAa,CAC5BV,GAAG,CAACM,IAAJ,CAAS,CAAC,IAAIG,IAAI,CAACR,CAAV,CAAY,IAAIQ,IAAI,CAACJ,CAArB,CAAT,EACD,CAFD,EAGAtB,aAAa,CAAC,IAAd,CACA;AACA,MAAO,CAAC,MAAMiB,GAAP,CAAP,CACD,CAXD,EAYD,C,uCACO,iBACN,GAAIW,CAAAA,GAAG,CAAC,KAAR,CACA,KAAKhB,KAAL,CAAWY,GAAX,CAAeC,OAAf,CAAuB,SAACI,QAAD,CAAWF,CAAX,CAAiB,CACtC,GAAIG,CAAAA,IAAI,CAAC,KAAT,CACA,GAAIC,CAAAA,IAAI,CAAC,KAAT,CACA,GAAIC,CAAAA,OAAO,CAAC,MAAI,CAACpB,KAAL,CAAWoB,OAAvB,CACA,GAAGH,QAAQ,CAACX,CAAT,CAAWc,OAAO,CAACd,CAAnB,EAAsBc,OAAO,CAACd,CAAR,CAAUW,QAAQ,CAACX,CAAT,CAAWtB,OAA9C,CAAsD,CAACkC,IAAI,CAAC,IAAL,CAAU,CACjE,GAAGD,QAAQ,CAACX,CAAT,CAAWc,OAAO,CAACd,CAAR,CAAUpB,SAArB,EAAgCkC,OAAO,CAACd,CAAR,CAAUpB,SAAV,CAAoB+B,QAAQ,CAACX,CAAT,CAAWtB,OAAlE,CAA0E,CAACkC,IAAI,CAAC,IAAL,CAAU,CACrF,GAAGD,QAAQ,CAACP,CAAT,EAAYU,OAAO,CAACV,CAAR,CAAUvB,SAAtB,EAAiCiC,OAAO,CAACV,CAAR,CAAUvB,SAAV,EAAqB8B,QAAQ,CAACP,CAAT,CAAWzB,OAApE,CAA4EkC,IAAI,CAAC,IAAL,CAC5E,GAAG,MAAI,CAACnB,KAAL,CAAWqB,aAAX,CAAyBC,GAAzB,CAA6B,CAAhC,CAAkCJ,IAAI,CAAC,KAAL,CAClC,GAAG,CAACF,GAAJ,CAAQA,GAAG,CAACE,IAAI,EAAEC,IAAV,CACR,GAAGH,GAAG,EAAED,CAAC,EAAE,MAAI,CAACf,KAAL,CAAWY,GAAX,CAAeW,MAAf,CAAsB,CAA9B,EAAiChC,OAAO,GAAG,KAA9C,CAAoD,CAClDA,OAAO,CAAC,IAAR,CACA,MAAI,CAACiC,IAAL,GACD,CACF,CAbD,EAcA,MAAOR,CAAAA,GAAP,CACD,C,yCAGQ,CACP;AACA,KAAKb,QAAL,CAAc,SAAAC,IAAI,QAAG,CACnB,UAAU,CAAC,IAAIA,IAAI,CAACgB,OAAL,CAAad,CAAb,CAAe,CAAChB,KAAK,CAACD,IAAP,EAAa,EAAjC,CAAoC,IAAIe,IAAI,CAACgB,OAAL,CAAaV,CAAb,CAAeN,IAAI,CAACiB,aAAL,CAAmBC,GAA1E,CADS,CAEnB,gBAAgB,CAAC,MAAMlB,IAAI,CAACiB,aAAL,CAAmBI,GAAnB,CAAuBrB,IAAI,CAACiB,aAAL,CAAmBC,GAAjD,CAAqD,MAAMlB,IAAI,CAACiB,aAAL,CAAmBC,GAAnB,CAAuB,CAAlF,CAFG,CAAH,EAAlB,EAIA,GAAGlC,aAAH,CAAiB,CACf,GAAIsC,CAAAA,GAAG,CAAC,CAAR,CACA,KAAKvB,QAAL,CAAc,SAAAC,IAAI,CAAE,CAClB,GAAIC,CAAAA,GAAG,CAAC,EAAR,CACAD,IAAI,CAACQ,GAAL,CAASC,OAAT,CAAiB,SAACC,IAAD,CAAOC,CAAP,CAAa,CAC5B,GAAGD,IAAI,CAACJ,CAAL,CAAOgB,GAAP,EAAY3C,MAAf,CAAsB,CACpBK,aAAa,CAAC,KAAd,CACAG,OAAO,CAAC,KAAR,CACD,CAHD,IAIKc,CAAAA,GAAG,CAACM,IAAJ,CAAS,CAAC,IAAIG,IAAI,CAACR,CAAV,CAAY,IAAIQ,IAAI,CAACJ,CAAL,CAAOgB,GAAvB,CAAT,EACN,CAND,EAOA,MAAO,CAAC,MAAMrB,GAAP,CAAW,UAAU,CAAC,IAAID,IAAI,CAACgB,OAAL,CAAad,CAAlB,CAAoB,IAAIF,IAAI,CAACgB,OAAL,CAAaV,CAAb,CAAegB,GAAvC,CAArB,CAAP,CACD,CAVD,EAWD,CACD,GAAG,KAAK1B,KAAL,CAAWoB,OAAX,CAAmBV,CAAnB,CAAqBvB,SAArB,CAA+BJ,MAAlC,CAAyC,CACvC4C,aAAa,CAACnC,QAAD,CAAb,CACA,KAAKW,QAAL,CAAc,SAACC,IAAD,QAAS,CAAC,UAAU,CAAC,IAAIA,IAAI,CAACgB,OAAL,CAAad,CAAlB,CAAoB,IAAIvB,MAAM,CAACI,SAA/B,CAAX,CAAT,EAAd,EACD,CACD,GAAG,KAAKyC,MAAL,EAAH,CAAiB,CACf,KAAKzB,QAAL,CAAc,SAACC,IAAD,CAAQ,CACpB,MAAO,CAAC,gBAAgB,CAAC,MAAM,CAAC,EAAR,CAAW,MAAM,CAACA,IAAI,CAACiB,aAAL,CAAmBI,GAArC,CAAjB,CAAP,CACD,CAFD,EAGD,CACF,C,6DAGkB,iBACjB,GAAIpB,CAAAA,GAAG,CAAC,EAAR,CACA,IAAI,GAAIU,CAAAA,CAAC,CAAC,CAAV,CAAYA,CAAC,EAAE,CAAf,CAAiBA,CAAC,EAAlB,CAAqB,CACnB,GAAIT,CAAAA,CAAC,CAACC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,IAAe3B,KAAK,CAACE,OAArB,CAAX,CAAN,CACA,GAAI0B,CAAAA,CAAC,CAAC,IAAIK,CAAJ,CAAM,EAAZ,CACAV,GAAG,CAACM,IAAJ,CAAS,CAAC,IAAIL,CAAL,CAAO,IAAII,CAAX,CAAT,EACD,CACD,GAAIU,CAAAA,OAAO,CAAC,CAAC,IAAIf,GAAG,CAACA,GAAG,CAACkB,MAAJ,CAAW,CAAZ,CAAH,CAAkBjB,CAAlB,CAAoBtB,OAAO,CAAC,CAA5B,CAA8BE,SAAS,CAAC,CAA7C,CAA+C,IAAImB,GAAG,CAACA,GAAG,CAACkB,MAAJ,CAAW,CAAZ,CAAH,CAAkBb,CAAlB,CAAoB,GAAvE,CAAZ,CACA,KAAKP,QAAL,CAAc,CAAC,MAAME,GAAP,CAAW,UAAUe,OAArB,CAAd,EACA5B,QAAQ,CAACqC,WAAW,CAAC,UAAI,CACvB,MAAI,CAACC,OAAL,GACD,CAFmB,CAElB,EAFkB,CAApB,CAGD,C,uCACO,CACN,GAAMC,CAAAA,MAAM,CAAC,KAAK/B,KAAL,CAAWY,GAAX,CAAeoB,GAAf,CAAmB,SAAAlB,IAAI,CAAI,CACtC,mBAAO,oBAAC,KAAD,EAAO,CAAC,CAAEA,IAAI,CAACR,CAAf,CAAkB,CAAC,CAAEQ,IAAI,CAACJ,CAA1B,EAAP,CACD,CAFY,CAAb,CAGA,mBACE,2BAAK,SAAS,CAAC,MAAf,EACGqB,MADH,cAEE,oBAAC,OAAD,EAAS,IAAI,CAAE1C,IAAf,CAAqB,KAAK,CAAEC,KAA5B,CAAmC,CAAC,CAAE,KAAKU,KAAL,CAAWoB,OAAX,CAAmBd,CAAzD,CAA4D,CAAC,CAAE,KAAKN,KAAL,CAAWoB,OAAX,CAAmBV,CAAlF,EAFF,CADF,CAMD,C,kBAtGgB/B,KAAK,CAACsD,S,EA0GzB,cAAelC,CAAAA,IAAf","sourcesContent":["import React from 'react'\nimport Floor from './Floor'\nimport Doodler from './Doodler'\nconst WIDTH=400, HEIGHT=800, FLOOR_W=80,FLOOR_H=15,DOODLER_W=64,DOODLER_H=64\nlet movePlatforms=false,left=false,right=false,jumping=false,interval=null,result=0\nwindow.onkeyup=function(e){\n  if(e.key==='ArrowLeft')left=false\n  if(e.key==='ArrowRight')right=false\n}\nwindow.onkeydown=function(e){\n  if(e.key==='ArrowLeft')left=true\n  if(e.key==='ArrowRight')right=true\n}\nclass Grid extends React.Component{\n  constructor(){\n    super()\n    this.state={\n      'pos':[],\n      'doodler':{},\n      'doodler_speed':{'vel':0,'acc':10}\n    }\n    /*setInterval(()=>{\n      this.setState((prev)=>{'doodler':{'x':prev.doodler.x,'y':prev.doodler.y+prev.doodler_speed.acc},'doodler_speed':{'vel':prev.doodler_speed.vel+prev.doodler_speed.acc,'acc',prev.doodler_speed.acc+1}})\n    },1000)*/\n  }\n  jump(){\n    console.log(++result)\n    this.setState(prev=>{\n      let tab=[]\n      let x=Math.floor(Math.random()*(WIDTH-FLOOR_W))\n      let y=20;\n      tab.push({'x':x,'y':y})\n      prev.pos.forEach((item, i) => {\n        tab.push({'x':item.x,'y':item.y})\n      });\n      movePlatforms=true\n      //console.log(tab)\n      return {'pos':tab}\n    })\n  }\n  colide(){\n    let tak=false\n    this.state.pos.forEach((platform, i) => {\n      let takx=false\n      let taky=false\n      let doodler=this.state.doodler\n      if(platform.x<doodler.x&&doodler.x<platform.x+FLOOR_W){takx=true}\n      if(platform.x<doodler.x+DOODLER_W&&doodler.x+DOODLER_W<platform.x+FLOOR_W){takx=true}\n      if(platform.y<=doodler.y+DOODLER_H&&doodler.y+DOODLER_H<=platform.y+FLOOR_H)taky=true\n      if(this.state.doodler_speed.acc<0)takx=false\n      if(!tak)tak=takx&&taky\n      if(tak&&i!=this.state.pos.length-1&&jumping===false){\n        jumping=true\n        this.jump()\n      }\n    });\n    return tak\n  }\n\n\n  control(){\n    //1console.log(this.state.doodler_speed.acc)\n    this.setState(prev=>({\n      'doodler':{'x':prev.doodler.x+(right-left)*10,'y':prev.doodler.y+prev.doodler_speed.acc},\n      'doodler_speed':{'vel':prev.doodler_speed.vel+prev.doodler_speed.acc,'acc':prev.doodler_speed.acc+1}\n    }))\n    if(movePlatforms){\n      let gap=7\n      this.setState(prev=>{\n        let tab=[]\n        prev.pos.forEach((item, i) => {\n          if(item.y+gap>=HEIGHT){\n            movePlatforms=false\n            jumping=false\n          }\n          else tab.push({'x':item.x,'y':item.y+gap})\n        });\n        return {'pos':tab,'doodler':{'x':prev.doodler.x,'y':prev.doodler.y+gap}}\n      })\n    }\n    if(this.state.doodler.y+DOODLER_H>HEIGHT){\n      clearInterval(interval)\n      this.setState((prev)=>({'doodler':{'x':prev.doodler.x,'y':HEIGHT-DOODLER_H}}))\n    }\n    if(this.colide()){\n      this.setState((prev)=>{\n        return {'doodler_speed':{'acc':-17,'vel':-prev.doodler_speed.vel}}\n      })\n    }\n  }\n\n\n  componentDidMount(){\n    let tab=[]\n    for(let i=1;i<=5;i++){\n      let x=Math.floor(Math.random()*(WIDTH-FLOOR_W))\n      let y=130*i+20;\n      tab.push({'x':x,'y':y})\n    }\n    let doodler={'x':tab[tab.length-1].x+FLOOR_W/2-DOODLER_W/2,'y':tab[tab.length-1].y-170}\n    this.setState({'pos':tab,'doodler':doodler})\n    interval=setInterval(()=>{\n      this.control()\n    },50)\n  }\n  render(){\n    const floors=this.state.pos.map(item => {\n      return <Floor x={item.x} y={item.y} />\n    });\n    return(\n      <div className='grid'>\n        {floors}\n        <Doodler left={left} right={right} x={this.state.doodler.x} y={this.state.doodler.y} />\n      </div>\n    )\n  }\n}\n\n\nexport default Grid\n"]},"metadata":{},"sourceType":"module"}